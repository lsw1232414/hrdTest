package com.ex;

import com.lsw.conn.DBConnection;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class Ex3 {

    public Ex3() {

        try (Connection conn = DBConnection.getConnection()) {

            if (conn == null) return;

            // 1️⃣ 조회: 급여 3,000,000 이상인 사원
            String selectSql = "SELECT EmpName, Dept, Salary FROM Employee WHERE Salary >= 3000000";
            try (Statement stmt = conn.createStatement();
                 ResultSet rs = stmt.executeQuery(selectSql)) {

                System.out.println("=== 급여 3,000,000 이상인 사원 ===");
                while (rs.next()) {
                    System.out.println(rs.getString("EmpName") + " | " +
                                       rs.getString("Dept") + " | " +
                                       rs.getInt("Salary"));
                }
            }

            // 2️⃣ 수정: 이순신 급여 3,500,000
            String updateSql = "UPDATE Employee SET Salary = ? WHERE EmpName = ?";
            try (PreparedStatement pstmt = conn.prepareStatement(updateSql)) {
                pstmt.setInt(1, 3500000);
                pstmt.setString(2, "이순신");
                int count = pstmt.executeUpdate();
                System.out.println("=== 이순신 급여 수정 완료: " + count + "건 ===");
            }

            // 3️⃣ 삭제: EmpNO = 1
            String deleteSql = "DELETE FROM Employee WHERE EmpNO = ?";
            try (PreparedStatement pstmt = conn.prepareStatement(deleteSql)) {
                pstmt.setInt(1, 1);
                int count = pstmt.executeUpdate();
                System.out.println("=== 사번 1번 사원 삭제 완료: " + count + "건 ===");
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}